#!/usr/bin/env node
var debug = require('debug')('express');
var app = require('../app');
// ~ http server

app.set('port', process.env.PORT || 3000);

var server = app.listen(app.get('port'), function() {
  debug('Express server listening on port ' + server.address().port);
});

// ~ socket.io
var io = require('socket.io').listen(server);

io.sockets.on('connection', function (socket) {
    socket.emit('news', { hello: 'world' });
    socket.on('my other event', function (data) {
        console.log(data);
    });
});


// ~ binary js
var BinaryServer = require('binaryjs').BinaryServer;
var fs = require('fs');

// ~ Start Binary.js server
var binaryServer = BinaryServer({port: 9000});
// Wait for new user connections
binaryServer.on('connection', function(client){
    // Stream a flower as a hello!
    var file = fs.createReadStream(__dirname + '/flower.png');
    client.send(file);
});
